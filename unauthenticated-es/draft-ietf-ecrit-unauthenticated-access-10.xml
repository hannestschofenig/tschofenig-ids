<?xml version="1.0" encoding="US-ASCII"?>
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>
<?rfc toc="yes" ?>
<?rfc symrefs="yes" ?>
<?rfc sortrefs="no"?>
<?rfc iprnotified="no" ?>
<?rfc strict="no" ?>
<?rfc compact="no" ?>
<?rfc subcompact="no" ?>
<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!-- <!ENTITY RFC5985 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5985.xml"> --> 
<!ENTITY RFC5687 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5687.xml">
<!ENTITY RFC6443 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6443.xml">
<!ENTITY RFC5031 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5031.xml">
<!ENTITY RFC4119 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.4119.xml">
<!ENTITY RFC5491 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5491.xml">
<!ENTITY RFC5139 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5139.xml">
<!ENTITY RFC5012 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5012.xml">
<!ENTITY RFC6881 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6881.xml">
<!ENTITY RFC5069 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5069.xml">
<!ENTITY RFC3261 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3261.xml">
<!ENTITY RFC5216 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5216.xml">
<!ENTITY I-D.winterbottom-geopriv-lis2lis-req PUBLIC "" "http://xml.resource.org/public/rfc/bibxml3/reference.I-D.winterbottom-geopriv-lis2lis-req.xml">
<!ENTITY RFC2119 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC6280 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6280.xml">
<!ENTITY RFC5222 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5222.xml">
<!ENTITY RFC5223 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.5223.xml">
<!ENTITY RFC3748 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.3748.xml">
<!ENTITY RFC6444 PUBLIC "" "http://xml.resource.org/public/rfc/bibxml/reference.RFC.6444.xml">
]>
<rfc category="std" docName="draft-ietf-ecrit-unauthenticated-access-10.txt"
     ipr="trust200902">
  <front>
    <title abbrev="Unauthenticated Emergency Service">Extensions to the
    Emergency Services Architecture for dealing with Unauthenticated and
    Unauthorized Devices</title>

    <author fullname="Henning Schulzrinne" initials="H." surname="Schulzrinne">
      <organization>Columbia University</organization>

      <address>
        <postal>
          <street>Department of Computer Science</street>

          <street>450 Computer Science Building</street>

          <city>New York</city>

          <region>NY</region>

          <code>10027</code>

          <country>US</country>
        </postal>

        <phone>+1 212 939 7004</phone>

        <email>hgs+ecrit@cs.columbia.edu</email>

        <uri>http://www.cs.columbia.edu</uri>
      </address>
    </author>

    <author fullname="Stephen McCann" initials="S." surname="McCann">
      <organization>Research in Motion UK Ltd</organization>

      <address>
        <postal>
          <street>200 Bath Road</street>

          <city>Slough</city>

          <region>Berks</region>

          <code>SL1 3XE</code>

          <country>UK</country>
        </postal>

        <phone>+44 1753 667099</phone>

        <email>smccann@rim.com</email>

        <uri>http://www.rim.com</uri>
      </address>
    </author>

    <author fullname="Gabor Bajko" initials="G." surname="Bajko">
      <organization></organization>

      <address>
        <email>gaborbajko@gmail.com</email>
      </address>
    </author>

    <author fullname="Hannes Tschofenig" initials="H." surname="Tschofenig">
      <organization></organization>

      <address>
        <postal>
          <street></street>

          <city>Hall in Tirol</city>

          <code>6060</code>

          <country>Austria</country>
        </postal>

        <email>Hannes.Tschofenig@gmx.net</email>

        <uri>http://www.tschofenig.priv.at</uri>
      </address>
    </author>

    <author fullname="Dirk Kroeselberg" initials="D." surname="Kroeselberg">
      <organization>Siemens</organization>

      <address>
        <postal>
          <street></street>

          <city></city>

          <code></code>

          <country>Germany</country>
        </postal>

        <phone></phone>

        <email>dirk.kroeselberg@siemens.com</email>
      </address>
    </author>

    <date year="2014" />

    <area>Real-time Applications and Infrastructure</area>

    <workgroup>ECRIT</workgroup>

    <keyword>Internet-Draft</keyword>

    <abstract>
    
    <t>This document provides a problem statement, introduces terminology
   and describes an extension for the base IETF emergency services
   architecture to address cases where an emergency caller is not
   authenticated, has no identifiable service provider, or has no remaining
   credit with which to pay for access to the network.
   </t>

<!--    
      <t>The IETF emergency services architecture assumes that the calling
      device has acquired rights to use the access network or that no
      authentication is required for the access network, such as for public
      wireless access points. Subsequent protocol interactions, such as
      obtaining location information, learning the address of the Public
      Safety Answering Point (PSAP) and the emergency call itself are largely
      decoupled from the underlying network access procedures.</t>

      <t>In some cases, however, the device does not have these credentials
      for network access, does not have a VoIP service provider, or the
      credentials have become invalid, e.g., because the user has exhausted
        their prepaid balance or the account has expired.</t>
      
      <t>With features provided by the Public Switched Telephone Network (PSTN) 
      there is precedent for some of these use cases and the transition to IP-based 
      emergency calling creates the desire to replicate functionality the PSTN 
      already offers today. For example, in many countries persons seeking help 
      are empowered to initiate emergency calls without having a Subscriber 
      Identity Module (SIM) in their mobile phone. 
      </t>

      <t>This document provides a problem statement, introduces terminology
      and describes an extension for the base IETF emergency services
      architecture to address these scenarios.</t>

--> 
      
    </abstract>
  </front>

  <middle>
    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="introduction" title="Introduction">
      <t>Summoning police, the fire department or an ambulance in emergencies
      is one of the fundamental and most-valued functions of the telephone. As
      telephone functionality moves from circuit-switched telephony to
      Internet telephony, its users rightfully expect that this core
      functionality will continue to work at least as well as it has for the
      older technology. New devices and services are being made available that
      could be used to make a request for help, those devices are not traditional telephones, 
      and users are increasingly expecting them to be used to
      place emergency calls.</t>

      <t>Roughly speaking, the IETF emergency services architecture (see <xref
      target="RFC6881"></xref> and <xref
      target="RFC6443"></xref>) divides responsibility for handling
   emergency calls among the access network (ISP); the application
   service provider (ASP), which may be a VoIP service provider (VSP);
   and the provider of emergency signaling services, the emergency
   service network (ESN). The access network may provide location information to
      end systems, but does not have to provide any ASP signaling
      functionality. The emergency caller can reach the ESN either directly or
      through the ASP's outbound proxy. Any of the three parties can provide
      the mapping from location to PSAP URI by offering LoST <xref
      target="RFC5222"></xref> services.</t>

      <t>In general, a set of automated configuration mechanisms allows a
      device to function in a variety of architectures, without the user being
      aware of the details on who provides location, mapping services or call
      routing services. However, if emergency calling is to be supported when
      the calling device lacks access network authorization or does not have
      an ASP, one or more of the providers may need to provide additional
      services and functions.</t>

      <t>In all cases, the end device has to be able to perform a LoST lookup
      and otherwise conduct the emergency call in the same manner as when the
      three exceptional conditions discussed below do not apply.</t>

      <t>We distinguish among three conditions:</t>

      <t><list style="hanging">
          <t hangText="No Access Authentication (NAA):">In the NAA case, the
          emergency caller does not posses valid credentials for the access
          network. This includes the case where the access network allows
          pay-per-use, as is common for wireless hotspots, but there is
          insufficient time to enter credit card details and other
          registration information required for access. It also covers all
          cases where either no credentials are available at all, or the
          available credentials do not work for the given IAP/ISP. As a
          result, the NAA case basically combines the below NASP and ZBP
          cases, but at the IAP/ISP level. Support for emergency call handling
          in the NAA case is subject to the local policy of the ISP. Such
          policy may vary substantially between ISPs and typically depends on
          external factors that are not under the ISP control.<vspace
          blankLines="1" /></t>

          <t hangText="No ASP (NASP):">The caller does not have an ASP at the
          time of the call. This can occur either in case the caller does not
          possess any valid subscription for a reachable ASP, or in case none
          of the ASPs where the caller owns a valid subscription is reachable
          through the ISP. <vspace blankLines="1" /> Note: The
          interoperability need is increased with this scenario since the
          client software used by the emergency caller must be compatible with
          the protocols and extensions deployed by the ESN.<vspace
          blankLines="1" /></t>

          <t hangText="Zero-balance ASP (ZBP):">In the case of zero-balance
          ASP, the ASP can authenticate the caller, but the caller is not
          authorized to use ASP services, e.g., because the contract has
          expired or the prepaid account for the customer has been depleted.
          <vspace blankLines="1" /></t>
        </list></t>

      <t>These three cases are not mutually exclusive.  A caller in need of
   help may, for example, be in a NAA and NASP situation, as explained
   in more detail in  <xref target="flow"></xref>. Depending
      on local policy and regulations, it may not be possible to place
      emergency calls in the NAA case. Unless local regulations require user
      identification, it should always be possible to place calls in the NASP
      case, with minimal impact on the ISP. Unless the ESN requires that all
      calls traverse a known set of VSPs, it is technically possible to let a
      caller place an emergency call in the ZBP case. We discuss each case in
      more details in <xref target="categories"></xref>.</t>
<!-- 
      <t>Note: At the time of writing there is no regulation in place that
      demands the functionality described in this memo. SDOs have started
      their work on this subject in a proactive fashion in the anticipation
      that national regulation will demand it for a subset of network
      environments.</t>
-->
      <t>As mentioned in the abstract some of the functionality provided in this document 
        is already available in the PSTN. Consequently, there is real-world experience available and not all of it is positive. 
        For example, the functionality of SIM-less calls in today's cellular system has lead to a fair amount of hoax or test calls in
        certain countries. This
      causes overload situations at PSAPs, which is considered harmful to the
      overall availability and reliability of emergency services.</t>

      <t><list style="empty"><t>As an example, Federal Office of Communications (OFCOM, Switzerland)
      provided statistics about emergency (112) calls in Switzerland from Jan.
      1997 to Nov. 2001. Switzerland did not offer SIM-less emergency calls
      except for almost a month in July 2000 where a significant increase in
      hoax and test calls was reported. As a consequence, the functionality
      was disabled again. More details can be found in the panel presentations
      of the 3rd SDO Emergency Services Workshop <xref
        target="esw07"></xref>.</t>
      </list></t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="terminology" title="Terminology">
      <t>In this document, the key words "MUST", "MUST NOT", "REQUIRED",
      "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
      "OPTIONAL" are to be interpreted as described in RFC 2119 <xref
      target="RFC2119"></xref>.</t>

      <t>This document reuses terminology from <xref target="RFC5687"></xref>
      and <xref target="RFC5012"></xref>, namely Internet Access Provider
      (IAP), Internet Service Provider (ISP), Application Service Provider
      (ASP), Voice Service Provider (VSP), Emergency Service Routing Proxy
      (ESRP), Public Safety Answering Point (PSAP), Location Configuration
      Server (LCS), (emergency) service dial string, and (emergency) service
      identifier.</t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="categories" title="Use Case Categories">
      <t>On a very high-level, the steps to be performed by an end host that is not attached 
      to the network and the user starting to make an emergency
      call are the following:</t>

      <t><list style="hanging">
          <t hangText="Link Layer Attachment:">Some networks have added
          support for unauthenticated emergency access, some other type of
          networks advertise these capabilities using layer beacons. The end
          host learns about these unauthenticated emergency services
          capabilities either from the link layer type or from advertisement.
          <vspace blankLines="1" /> The end host uses the link layer specific
          network attachment procedures defined for unauthenticated network
          access in order to get access to the network. <vspace
          blankLines="1" /></t>

          <t hangText="Pre-Emergency Service Configuration:">When the link
          layer network attachment procedure is completed the end host learns
          basic configuration information using DHCP from the ISP. The end
          host uses a Location Configuration Protocol (LCP) to retrieve
          location information. Subsequently, the LoST protocol <xref
          target="RFC5222"></xref> is used to learn the relevant emergency
          numbers, and to obtain the PSAP URI applicable for that
          location.<vspace blankLines="1" /></t>

          <t hangText="Emergency Call:">In case of need for help, a user dials
          an emergency number and the SIP UA initiates the emergency call
          procedures by communicating with the PSAP.</t>
        </list>
      </t>

      <t><xref target="flow"></xref> compiles the basic logic taking place
      during network entry for requesting an emergency service and shows the
      interrelation between the three conditions described in the above
      section.<vspace blankLines="1" /></t>

      <t><figure anchor="flow" title="Flow Diagram: NAA, ZBP, and NSAP Scenarios.">
          <artwork><![CDATA[
                      +-----Y
                      |Start|
                      `...../
                         |
                         | Are credentials
                         | for network attachment
                         | available?
                         |
            NO           v         YES
          +----------------------------+
          |                            |
          |                            |
          V                            v
     ..............               ................
     | Idle: Wait |               |Execute       |
     | for ES Call|               |LLA Procedures|
     | Initiation |               "--------------'
     "------------'                    |
 Is        |               +---------->O
 emergency |               |           | Is ASP
 service   | NO +-----Y    |           | configured?
 network   +--->| End |    |           +---------------+
 attachment|    `...../    |       YES |               | NO
 possible? |               |           |               |
           v               |           v               v
     +------------+        |     +------------+    +------------+
     | Execute    |        |     | Execute    |    | Execute    |
     | NAA        |--------+     | Phone BCP  |    | NASP       |
     | Procedures |              | Procedures |    | Procedures |
     +------------+              +------------+    +------------+
                      Authorization for|                |
                         making an     |                |
                      emergency call   |                |
                      with the ASP/VSP?|                |
                        +--------------+                v
                        | NO           | YES         +-----Y
                        |              |             | Done|
                        v              v             `...../
                 +------------+  +------------+
                 | Execute    |  | Execute    |
                 | ZBP        |  | Phone BCP  |
                 | Procedures |  | Procedures |
                 +------------+  +------------+
                        |              |
                        |              |
                        v              v
                     +-----Y        +-----Y
                     | Done|        | Done|
                     `...../        `...../

Abbreviations: 
  LLA: Link Layer Attachment
  ES: Emergency Services
     ]]></artwork>
        </figure>
      </t>
        
      <t>The diagrams below highlight the most important steps for the three cases.</t>
      <t><figure anchor="flow-naa" title="Flow Diagram: NAA Scenario.">
        <artwork><![CDATA[
            +-----Y
            |Start|
            `...../
               |
               | No
               | credentials
               | for network access
               | available
               v
         ..............
         | Idle: Wait |
         | for ES Call|
         | Initiation |
         "------------'
               |
               |
               |
               v
               --
             //  --
            /      --
          //  Is     --
         /  emergency  --
         |   service    |  NO   +--------+
         |   network    |------>| Call   |
         |  attachment  |         Failed |
         \  possible?   /       `......./
          \           //
           \\       //
             \    //
              \--/
               |
               | YES
               |
               |
               v
         +------------+
         | Execute    |
         | NAA        |
         | Procedures |
         +------------+
               |
               | Network 
               | attachment 
               | in progress
               v
             /--\  Continue
            |    | with
            |    | application
             \--/  layer interaction
        ]]></artwork>
      </figure>
    </t>
      
    <t><figure anchor="flow-zbp" title="Flow Diagram: ZBP Scenario.">
        <artwork><![CDATA[
                     +-----+
        +------------|Start|-----------------+
        |            `...../                 |
        v                                    v
  +------------+                     +----------------+
  | NAA        |                     | Regular        |
  | Procedures |                     | Network Access |
  +------------+                     | Procedures     |
        |                            +----------------+
        |                                    |
        |                                    |
        ----------------o--------------------+
                        |
                        |
                        |
                        |
                    Network
                    Attachment
                    Completed
                        |
                        |
                        |
                        |
                        v
                  +------------+      +---------+
                  | ASP        |  NO  | See     |
                  | Configured?|----->| main    |
                  +------------+      | diagram |
                        |             `......../
                        |
                        | YES
                        |
                        v
                     //----
                    /      --
                  //         --
                 /              -       +---------+
                 | Authorization|  YES  | See     |
                 | for making   |------>| main    |
                 |   ES call    |       | diagram |
                 \    with      /       `......../
                  \  VSP/ASP? //
                   \\       //
                     \    //
                      \--/
                        |
                        | NO
                        |
                        |
                        v
                  +------------+
                  | Execute    |
                  | ZBP        |
                  | Procedures |
                  +------------+
                        |
                        | Call
                        | in progress
                        |
                        v
                    +--------+
                    | Call   |
                      Success|
                    `......./
        ]]></artwork>
      </figure>
    </t>
      
    <t><figure anchor="flow-nasp" title="Flow Diagram: NASP Scenario. ">
        <artwork><![CDATA[
                           +-----+
              +------------|Start|-----------------+
              |            `...../                 |
              v                                    v
        +------------+                     +----------------+
        | NAA        |                     | Regular        |
        | Procedures |                     | Network Access |
        +------------+                     | Procedures     |
              |                            +----------------+
              |                                    |
              |                                    |
              ----------------o--------------------+
                              |
                              |
                              |
                              |
                          Network
                          Attachment
                          Completed
                              |
                              |
                              |
                              |
                              v
                        +------------+      +---------+
                        | ASP        |  YES | See     |
                        | Configured?|----->| main    |
                        +------------+      | diagram |
                              |             `......../
                              |
                              | NO
                              |
                              v
                        +------------+
                        | Execute    |
                        | NASP       |
                        | Procedures |
                        +------------+
                              |
                              | Call
                              | in progress
                              |
                              v
                          +--------+
                          | Call   |
                            Success|
                          `......./          
        ]]></artwork>
      </figure>
    </t>
    <t>The "No Access Authentication (NAA)" procedures are described in <xref target="lower"/>. The "Zero-balance ASP (ZBP)" procedures are described in <xref target="zbp-considerations"/>. The "No ASP (NASP)" procedures are described in <xref target="nasp-considerations"/>. The Phone BCP procedures are described in <xref target="RFC6881"/>. The "Link Layer Attachment (LLA)" procedures are not described in this document since they are specific to the link layer technology in use.</t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="zbp-considerations" title="ZBP Considerations">
    
      <t>ZBP includes all cases where a subscriber is known to an ASP, but lacks the necessary authorization to access regular ASP services.  Example ZBP cases include empty prepaid accounts, barred accounts, roaming and mobility restrictions, or any other conditions set by ASP policy.</t>
	
      <t>Local regulation might demand that emergency calls cannot proceed without successful service authorization. In regulatory regimes, however, it may be possible to allow emergency calls to continue despite authorization failures. To distinguish an emergency call from a regular call an ASP can identify emergency sessions by inspecting the service URN <xref target="RFC5031"/> used in call setup. The ZBP case therefore only affects the ASP.</t>

      <t>Permitting a call despite authorization failures could present an opportunity for abuse.  The ASP may choose to verify the destination of the emergency calls and to only permit calls to certain, pre-configured entities (e.g., to local PSAPs). <xref target="secconsiderations"/> discusses this topic in more detail.</t>

      <t>An ASP without a regulatory requirement to authorize emergency calls can deny emergency call setup.  Where an ASP does not authorize an emergency call, the caller may be able to fall back to NASP procedures.</t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="nasp-considerations" title="NASP Considerations">
      <t>To start the description we consider the sequence of steps that are
      executed in an emergency call based on <xref
      target="arch-fig"></xref>.</t>

      <t><list style="symbols">
          <t>As an initial step the devices attaches to the network as shown
          in step (1). This step is outside the scope of this section.</t>

          <t>When the link layer network attachment procedure is completed the
          end host learns basic IP configuration information using DHCP from the
          ISP, as shown in step (2).</t>

          <t>When the IP address configuration is completed then the end host
          starts an interaction with the discovered Location Configuration
          Server at the ISP, as shown in step (3). The ISP may in certain
          deployments need to interact with the IAP. This protocol exchange is
          shown in step (4).</t>

          <t>Once location information is obtained the end host triggers the
          LoST protocol to obtain the address of the ESRP/PSAP. This step is
          shown in (5).</t>

          <t>In step (6), the SIP UA initiates a SIP INVITE towards the
          indicated ESRP. The INVITE message contains all the necessary
          parameters required by <xref target="sip-client"></xref>.</t>

          <t>The ESRP receives the INVITE and processes it according to the
          description in <xref target="esrp-sip"></xref>.</t>

          <t>The ESRP routes the call to the PSAP, as shown in (8),
          potentially interacting with a LoST server first to determine the
          route.</t>

          <t>The PSAP evaluates the initial INVITE and aims to complete the
          call setup.</t>

          <t>Finally, when the call setup is completed media traffic can be
          exchanged between the PSAP and the SIP UA.</t>
        </list>
      </t>

      <t>For editorial reasons the end-to-end SIP and media exchange between
      the PSAP and SIP UA are not shown in <xref
      target="arch-fig"></xref>.</t>

      <t><figure anchor="arch-fig" title="Architectural Overview">
          <artwork><![CDATA[
                               +-------+
                               | PSAP  |
                               |       |
                               +-------+
                                   ^
                                   | (8)
                                   |
            +----------+(7) +----------+
            | LoST     |<-->| ESRP     |
            | Server   |    |          |
            +----------+    +----------+
                  ^                ^
 +----------------+----------------|--------------+
 | ISP            |                |              |
 |+----------+    |                |  +----------+|
 || LCS-ISP  | (3)|                |  | DHCP     ||
 ||          |<-+ |                |  | Server   ||
 |+----------+  | |                |  +----------+|
 +-------^------+-+----------------|-----------^--+
 +-------|------+-+----------------|-----------|--+
 | IAP   | (4)  | |(5)             |           |  |
 |       V      | |                |           |  |
 |+----------+  | |                |           |  |
 || LCS-IAP  |  | |  +--------+    |           |  |
 ||          |  | |  | Link   |    |(6)        |  |
 |+----------+  | |  | Layer  |    |           |  |
 |              | |  | Device |    |        (2)|  |
 |              | |  +--------+    |           |  |
 |              | |       ^        |           |  |
 |              | |       |        |           |  |
 +--------------+-|-------|--------|-----------|--+
                | |       |        |           |
                | |    (1)|        |           |
                | |       |        |           |
                | |       |   +----+           |
                | |       v   |                |
                | |  +----------+              |
                | +->| End      |<-------------+
                +___>| Host     |
                     +----------+
              ]]></artwork>
        </figure>
      </t>

      <t>Note: <xref target="arch-fig"></xref> does not indicate who operates
      the ESRP and the LoST server. Various deployment options exist.</t>

      <section anchor="end-host" title="End Host Profile">

        <section title="LoST Server Discovery">
          <t>The end host MUST discover a LoST server <xref
          target="RFC5222"></xref> using DHCP <xref
          target="RFC5223"></xref> unless a LoST server has been provisioned using other means.</t>
        </section>

        <section title="ESRP Discovery">
          <t>The end host MUST discover the ESRP using the LoST protocol <xref
          target="RFC5222"></xref> unless a ESRP has been provisioned using other means.</t>
        </section>

        <section title="Location Determination and Location Configuration">
          <t>The end host MUST support location acquisition and the LCPs
          described in Section 6.5 of <xref
          target="RFC6881"></xref>. The description in Section
          6.5 and 6.6 of <xref target="RFC6881"></xref>
          regarding the interaction between the device and the LIS applies to
          this document.</t>

          <t>The SIP UA in the end host MUST attach available location
          information in a PIDF-LO <xref target="RFC4119"></xref> when making
          an emergency call. When constructing the PIDF-LO the guidelines in
          PIDF-LO profile <xref target="RFC5491"></xref> MUST be followed. For
          civic location information the format defined in <xref
          target="RFC5139"></xref> MUST be supported.</t>
        </section>

        <section title="Emergency Call Identification">
          <t>To determine which calls are emergency calls, some entity needs
          to map a user entered dialstring into this URN scheme. A user may
          "dial" 1-1-2, 9-1-1, etc., but the call would be sent to urn:service:sos. This
          mapping SHOULD be performed at the endpoint device.</t>

          <t>End hosts MUST use the Service URN mechanism <xref
          target="RFC5031"></xref> to mark calls as emergency calls for their
          home emergency dial string.</t>
        </section>

        <section anchor="sip-client" title="SIP Emergency Call Signaling">
          <t>SIP signaling capabilities <xref target="RFC3261"></xref> are
          REQUIRED for end hosts.</t>

          <t>The initial SIP signaling method is an INVITE. The SIP INVITE
          request MUST be constructed according to the requirements in Section
          9.2 <xref target="RFC6881"></xref>.</t>

          <t>Regarding callback behavior SIP UAs SHOULD place a globally
          routable URI in a Contact: header.</t>
        </section>

        <section anchor="client-media" title="Media">
          <t>End points MUST comply with the media requirements for end points
          placing an emergency call found in Section 14 of <xref
          target="RFC6881"></xref>.</t>
        </section>

        <section anchor="client-testing" title="Testing">
          <t>The description in Section 15 of <xref
          target="RFC6881"></xref> is fully applicable to this
          document.</t>
        </section>
      </section>

      <section anchor="isp" title="IAP/ISP Profile">
        <section title="ESRP Discovery">
          <t>An ISP MUST provision a DHCP server with information about LoST
          servers <xref target="RFC5223"></xref>. An ISP operator may choose
          to deploy a LoST server or to outsource it to other parties.</t>
        </section>

        <section title="Location Determination and Location Configuration">
          <t>The ISP is responsible for location determination and exposes
          this information to the end points via location configuration
          protocols. The considerations described in <xref
          target="RFC6444"></xref> are applicable
          to this document.</t>

          <t>The ISP MUST support one of the LCPs described in Section 6.5 of
          <xref target="RFC6881"></xref>. The description in
          Section 6.5 and 6.6 of <xref
          target="RFC6881"></xref> regarding the interaction
          between the end device and the LIS applies to this document.</t>

          <t>The interaction between the LIS at the ISP and the IAP is often
          priorietary but the description in <xref
          target="I-D.winterbottom-geopriv-lis2lis-req"></xref> may be
          relevant to the reader.</t>
        </section>
      </section>

      <section anchor="esrp" title="ESRP Profile">
        <section title="Emergency Call Routing">
          <t>The ESRP continues to route the emergency call to the PSAP
          responsible for the physical location of the end host. This may
          require further interactions with LoST servers but depends on the
          specific deployment.</t>
        </section>

        <section title="Emergency Call Identification">
          <t>The ESRP MUST understand the Service URN mechanism <xref
          target="RFC5031"></xref> (i.e., the 'urn:service:sos' tree).</t>
        </section>

        <section anchor="esrp-sip" title="SIP Emergency Call Signaling">
          <t>SIP signaling capabilities <xref target="RFC3261"></xref> are
          REQUIRED for the ESRP. The ESRP MUST process the messages sent by
          the client, according to <xref target="sip-client"></xref>.</t>
          
          <t>Furthermore, if a PSAP wants to support NASP calls, then it MUST NOT restrict
            incoming calls to a particular set of ASPs.</t>
        </section>
      </section>
      
      <!-- 
      
The URI scheme 
of the ESRP URI will determine what discovery mechanisms is to be 
used. In case of a SIP URI RFC 3263 is used, for example. 

--> 

    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="lower" title="Lower Layer Considerations for NAA Case">
      <t>Some networks have added support for unauthenticated emergency
      access, some other type of networks advertise these capabilities using
      layer beacons. The end host learns about these unauthenticated emergency
      services capabilities either from the link layer type or from
        advertisement.</t>
      
      <t>It is important to highlight that the NAA case is inherently a layer
        2 problem, and the general form of the solution is to provide an
        "emergency only" access type, with appropriate limits/monitoring to
        prevent abuse. The described mechanisms are informative in nature since the relationship 
        to the IETF emergency services architecture is only indirect, namely via some protocols developed within the 
      IETF (e.g., EAP and EAP methods) that require extensions to support this functionality. </t>

      <t>This section discusses different methods to indicate an emergency
      service request as part of network attachment. It provides some general
      considerations and recommendations that are not specific to the access
      technology.</t>

      <t>To perform network attachment and get access to the resources
      provided by an IAP/ISP, the end host uses access technology specific
      network attachment procedures, including for example network detection
      and selection, authentication, and authorization. For initial network
      attachment of an emergency service requester, the method of how the
      emergency indication is given to the IAP/ISP is specific to the access
      technology. However, a number of general approaches can be
      identified:</t>

      <t><list style="hanging">
          <t hangText="Link layer emergency indication:">The end host provides
          an indication, e.g., an emergency parameter or flag, as part of the
          link layer signaling for initial network attachment. Examples
          include an emergency bit signalled in the IEEE 802.16-2009 wireless
          link. In IEEE 802.11 WLAN, an emergency support indicator allows the
          station (i.e., end host in this context) to download before association 
          a Network Access Identifier (NAI), which it can use to
          request server side authentication only for an 802.1x network.
          <vspace blankLines="1" /></t>

          <t hangText="Higher-layer emergency indication:">Typically, emergency
          indication is provided in the network access authentication procedure. 
          The emergency caller's end host
          provides an indication as part of the access authentication
          exchanges. Authentication via the Extensible Authentication Protocol 
          (EAP) <xref target="RFC3748"/> is of particular relevance here.
          Examples are the EAP NAI decoration used in WiMAX networks and
          modification of the authentication exchange in IEEE 802.11. <xref
          target="nwgstg3"></xref>.<vspace blankLines="1" /></t>
        </list>
      </t>

      <section title="Link Layer Emergency Indication">
        <t>In general, link layer emergency indications provide good
        integration into the actual network access procedure regarding the
        enabling of means to recognize and prioritize an emergency service
        request from an end host at a very early stage of the network
        attachment procedure. However, support in end hosts for such methods
        cannot be considered to be commonly available.</t>

        <t>No general recommendations are given in the scope of this memo due
        to the following reasons:</t> 

        <t> <list style="symbols">
            <t>Dependency on the specific access technology.</t>

            <t>Dependency on the specific access network architecture. Access
            authorization and policy decisions typically happen at a different
            layers of the protocol stack and in different entities than those
            terminating the link-layer signaling. As a result, link layer
            indications need to be distributed and translated between the
            different involved protocol layers and entities. Appropriate
            methods are specific to the actual architecture of the IAP/ISP
            network.</t>

            <t>An advantage of combining emergency indications with the actual
            network attachment procedure performing authentication and
            authorization is the fact that the emergency indication can
            directly be taken into account in the authentication and
            authorization server that owns the policy for granting access to
            the network resources. As a result, there is no direct dependency
            on the access network architecture that otherwise would need to
            take care of merging link-layer indications into the AA and policy
            decision process.</t>

            <t>EAP signaling happens at a relatively early stage of network
            attachment, so it is likely to match most requirements for
            prioritization of emergency signaling. However, it does not cover
            early stages of link layer activity in the network attachment
            process. Possible conflicts may arise e.g. in case of MAC-based
            filtering in entities terminating the link-layer signaling in the
            network (like a base station). In normal operation, EAP related
            information will only be recognized in the NAS. Any entity
            residing between end host and NAS should not be expected to
            understand/parse EAP messages.</t>

            <t>An emergency indication can be given by forming a specific NAI
            that is used as the identity in EAP based authentication for
            network entry.</t>
          </list>
        </t>
      </section>

      <section title="Securing Network Attachment in NAA Cases">
        <t>For network attachment in NAA cases, it may make sense to secure
        the link-layer connection between the device and the IAP/ISP. This
        especially holds for wireless access with examples being IEEE 802.11
        or IEEE 802.16 based access. The latter even mandates secured
        communication across the wireless link for all IAP/ISP networks based
        on <xref target="nwgstg3"></xref>.</t>

        <t>Therefore, for network attachment that is by default based on EAP
        authentication it is desirable also for NAA network attachment to use
        a key-generating EAP method (that provides an MSK key to the
        authenticator to bootstrap further key derivation for protecting the
        wireless link).</t>

        <t>The following approaches to match the above can be identified:</t>

        <t><list style="hanging">
            <t hangText="1) Server-only Authentication:"><vspace
            blankLines="1" /> The device of the emergency service requester
            performs an EAP method with the IAP/ISP EAP server that performs
            server side authentication only. An example for this is EAP-TLS <xref target="RFC5216"/>.
            This provides a certain level of assurance about the IAP/ISP to
            the device user. It requires the device to be provisioned with
            appropriate trusted root certificates to be able to verify the
            server certificate of the EAP server (unless this step is
            explicitly skipped in the device in case of an emergency service
            request). This method is used to provide access of devices without
            existing credentials to an 802.1x network. The details are
            incorporated into the not yet published 802.11-2011
            specification.<vspace blankLines="1" /></t>

            <t hangText="2) Null Authentication:"><vspace blankLines="1" /> In
            one case (e.g., WiMAX) an EAP method is performed. However, no
            credentials specific to either the server or the device or
            subscription are used as part of the authentication exchange. An
            example for this would be an EAP-TLS exchange with using the
            TLS_DH_anon (anonymous) ciphersuite. Alternatively, a publicly
            available static key for emergency access could be used. In the
            latter case, the device would need to be provisioned with the
            appropriate emergency key for the IAP/ISP in advance. In another
            case (e.g., IEEE 802.11), no EAP method is used, so that empty
            frames are transported during the over the air IEEE 802.1X
            exchange. In this case the authentication state machine completes
            with no cryptographic keys being exchanged. <vspace
            blankLines="1" /></t>

            <t hangText="3) Device Authentication:"><vspace blankLines="1" />
            This case extends the server-only authentication case. If the
            device is configured with a device certificate and the IAP/ISP EAP
            server can rely on a trusted root allowing the EAP server to
            verify the device certificate, at least the device identity (e.g.,
            the MAC address) can be authenticated by the IAP/ISP in NAA cases.
            An example for this are WiMAX devices that are shipped with device
            certificates issued under the global WiMAX device public-key
            infrastructure. To perform unauthenticated emergency calls, if
            allowed by the IAP/ISP, such devices perform EAP-TLS based network
            attachment with client authentication based on the device
            certificate.</t>
          </list>
        </t>
      </section>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section anchor="secconsiderations" title="Security Considerations">
      <t>The security threats discussed in <xref target="RFC5069"></xref> are
      applicable to this document.</t>

      <t>There are a couple of new vulnerabilities raised with unauthenticated
      emergency services in NASP/NAA cases since the PSAP operator will
      typically not possess any identity information about the emergency caller
      via the signaling path itself. In countries where this functionality is
      used for GSM networks today this has lead to a significant amount of
      misuse.</t>

      <t>In the context of NAA, the IAP and the ISP will probably want to make
      sure that the claimed emergency caller indeed performs an emergency call
      rather than using the network for other purposes, and thereby acting
      fraudulent by skipping any authentication, authorization and accounting
      procedures. By restricting access of the unauthenticated emergency
      caller to the LoST server and the PSAP URI, traffic can be restricted
      only to emergency calls. This can be accomplished with traffic
      separation. The details, however, e.g. for using filtering, depend on
      the deployed ISP architecture and are beyond the scope of this
      document.</t>

      <t>We only illustrate a possible model. If the ISP runs its own (caching) 
      LoST
      server, the ISP would maintain an access control list populated with 
      IP-address information obtained from LoST responses (in the mappings). 
      These URIs would either be URIs for contacting further LoST servers or 
      PSAP URIs.  
      It may be necessary to translate domain names returned in LoST responses to IP addresses. 
      Since the media destination addresses are not
      predictable, the ISP also has to provide a SIP outbound proxy so that it
      can determine the media addresses and add those to the filter list.</t>

      <t>For the ZBP case the additional aspect of fraud has to be considered.
      Unless the emergency call traverses a PSTN gateway or the ASP charges
      for IP-to-IP calls, there is little potential for fraud. If the ASP also
      operates the LoST server, the outbound proxy MAY restrict outbound calls
      to the SIP URIs returned by the LoST server. It is NOT RECOMMENDED to
      rely on a fixed list of SIP URIs, as that list may change.</t>

      <t>RFC 6280 <xref
      target="RFC6280"></xref> discusses security vulnerabilities that are caused by 
      an adversary faking location information and thereby lying about the actual 
      location of the emergency caller. These threats may be less problematic in the 
      context of unauthenticated emergency when location information can be verified 
      by the ISP to fall within a specific geographical area.</t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section title="Acknowledgments">
      <t>Parts of this document are derived from <xref target="RFC6881"></xref>. 
      Participants of the 2nd and 3rd SDO Emergency Services Workshop provided helpful 
      input.</t>
      
      <t>We would like to thank Richard Barnes, Brian Rosen, James Polk, Marc Linsner, 
        and Martin Thomson for their feedback at the IETF#80 ECRIT meeting.</t>
      
      <t>Furthermore, we would like to thank Martin Thomson and Bernard Aboba for their 
        detailed document review in preparation of the 81st IETF meeting. Alexey Melnikov 
        was the General Area (Gen-Art) reviewer. A number of changes to the document 
        had been made in response to the AD review by Richard Barnes.</t>
		
	  <t>We would also like to thank review comments from various IESG members, including Stephen Farrell, Barry Leiba, Pete Resnick, Spencer Dawkins, Joel Jaeggli, and Ted Lemon.</t>
      
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <section title="IANA Considerations">
      <t>This document does not require actions by IANA.</t>
    </section>

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->

    <!--      <section title="Open Issues">
         <t>The following three high-level topics have been determined as open issues: <list
               style="symbols">
               <t>NAT Traversal: A certain NAT traversal story needs to be described and mandated.
                  Most likely ICE for both the PSAP and the end host.</t>
               <t>A DNS-based discovery procedure that discovers an ESRP in the local access network
                  may need to be provided.</t>
               <t>Text about link layer requirements are missing. These are necessary to make the
                  "big picture" complete. </t>
               <t>EAP method for emergency calls: Some of the discussions around the liaison request
                  from the IEEE to the IETF EMU WG need to get reflected.</t>
               <t>Quality of Service treatment for emergency calls has not been described in this
                  document</t>
            </list>
         </t>
      </section>
-->

    <!-- ////////////////////////////////////////////////////////////////////////////////// -->
  </middle>

  <!-- ////////////////////////////////////////////////////////////////////////////////// -->

  <back>
    <references title="Normative References">
      &RFC5031;

      &RFC4119;

      &RFC5491;

      &RFC5139;

      &RFC3261;

      &RFC2119;

      &RFC6881;

      &RFC5222;

      &RFC5223;
    </references>

    <references title="Informative References">
      &RFC5687;

      &RFC6443;

<!--      &I-D.ietf-geopriv-res-gw-lis-discovery; --> 

<!--      &RFC5985; --> 

      &RFC5012;

      &RFC6444;

      &I-D.winterbottom-geopriv-lis2lis-req;

      &RFC5069;
	  &RFC3748; 
      &RFC5216; 
      &RFC6280;

      <reference anchor="esw07">
        <front>
          <title>3rd SDO Emergency Services Workshop,
          http://www.emergency-services-coordination.info/2007Nov/</title>

          <author fullname="" initials="" surname="">
            <organization></organization>
          </author>

          <date month="October 30th - November 1st" year="2007" />
        </front>

        <format target="http://www.emergency-services-coordination.info/2007Nov/"
                type="html" />
      </reference>

      <reference anchor="nwgstg3">
        <front>
          <title>WiMAX Forum WMF-T33-001-R015V01, WiMAX Network Architecture
          Stage-3 http://www.wimaxforum.org/sites/wimaxforum.org/files/
          technical_document/2009/09/DRAFT-T33-001-R015v01-O_Network-Stage3-Base.pdf</title>

          <author fullname="" initials="" surname="">
            <organization></organization>
          </author>

          <date month="September" year="2009" />
        </front>

        <format target="http://www.wimaxforum.org/sites/wimaxforum.org/files/technical_document/2009/09/DRAFT-T33-001-R015v01-O_Network-Stage3-Base.pdf"
                type="html" />
      </reference>
    </references>
  </back>
</rfc>
